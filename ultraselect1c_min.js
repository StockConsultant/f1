jQuery&&function(e){var t;String.prototype.trim||(t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,String.prototype.trim=function(){return this.replace(t,"")});var s={selectAll:!0,maxlistitems:1,selectAllText:"ALL<div style='float:left;width:50px;'></div><div style='clear:both;'></div>",noneSelected:"Select",oneOrMoreSelected:"% selected",autoListSelected:!1,optGroupSelectable:!1,listHeight:250,maxWidth:!1};function i(e){var t=e.find(".selectable.hover").position().top+e.find(".selectable.hover").outerHeight();t>e.innerHeight()&&e.scrollTop(e.scrollTop()+t-e.innerHeight()),e.find(".selectable.hover").position().top<0&&e.scrollTop(e.scrollTop()+e.find(".selectable.hover").position().top)}function l(){var e=this.children(".select"),t=this.children(".options");this.data("ultraselect").options.maxWidth&&t.outerWidth()>e.width()&&e.css("maxWidth",t.outerWidth()+"px")}function a(t){if(this.data("ultraselect").options.optGroupSelectable){var s=!0;e(t).children(":not(.optGroupLabel)").find("input:checkbox").each(function(){e(this).is(":checked")||(s=!1)}),e(t).find("input.optGroup").prop("checked",s).parent().toggleClass("checked",s)}}function n(t){var s=this.children(".select"),i=this.children(".options"),l=s.find("span.selection"),a=this.data("ultraselect").options;if(a.multiple){var n=0,o=!0,c="";i.find("input:checkbox").not(".selectAll, .optGroup").each(function(){e(this).is(":checked")?(n+=1,c=c+e(this).parent().text().trim()+", "):o=!1}),c=c.replace(/\s*,\s*$/,""),0===n?s.find("span.selection").html(a.noneSelected):"*"===a.oneOrMoreSelected||a.autoListSelected?(l.html(c),s.attr("title",c),a.autoListSelected&&(o?l.html(a.selectAllText):n>a.maxlistitems&&l.html(a.oneOrMoreSelected.replace("%",n)))):l.html(a.oneOrMoreSelected.replace("%",n)),a.selectAll&&i.find("input.selectAll").prop("checked",o).parent().toggleClass("checked",o)}else{var r=this.children("input").val();i.find(".option").each(function(){if(e(this).data("value")===r)return l.html(e("label",this).text()),!1})}t&&this.trigger("change")}e.fn.selectAllItems=function(){var e=this.children(".select"),t=this.children(".options"),s=this.data("ultraselect").options,i=e.find("span.selection");s.multiple&&(t.find("input.selectAll").prop("checked",!0).parent().toggleClass("checked",!0),i.html(s.selectAllText))},e.fn.howmanyItems=function(){var e=this.children(".options"),t=this.data("ultraselect").options,s=0;return t.multiple&&e.find("input:checkbox").not(".selectAll, .optGroup").each(function(){s+=1}),s};var o=0;function c(t,s,i){var l=t+"_"+(o+=1),a=e("<div />",{class:"option"}),n=e("<input />",{type:"checkbox",name:i.name,id:l,tabindex:-1}),c=e("<label />",{for:l}),r=e("<span><span></span></span>");return a.addClass(s.classes||"").data(s.data),i.multiple?(n.val(s.value),s.selected&&n.prop("checked","checked"),a.append(n,c.append(r,s.text)).addClass(s.classes||"").data(s.data)):(a.data("value",s.value),s.selected&&a.data("selected","selected"),a.addClass("selectable").append(e("<label />").html(s.text)))}function r(t){var s="selectAll_"+(o+=1),l=e(this),r=l.children(".select"),d=l.children(".options"),h=this.data("ultraselect"),p=h.options,u=h.callback;d.html(""),p.multiple&&p.selectAll&&d.append(e("<div />",{class:"selectAll"}).append(e("<input />",{type:"checkbox",class:"selectAll",id:s,tabindex:-1}),e("<label />",{for:s}).append("<span><span></span></span>",p.selectAllText))),d.append(function t(s,i,l){var a,n,r,d,h=e("<div />",{class:"options"});for(n=0;n<i.length;n+=1)i[n].optgroup?((r=e("<div />")).attr("class",i[n].classes||null).addClass("optGroup").data(i[n].data),d=e("<label />"),l.multiple&&l.optGroupSelectable&&(a=s+"_"+(o+=1),r.append(e("<input />",{type:"checkbox",class:"optGroup",id:a,tabindex:-1})),d.attr("for",a).append("<span><span></span></span>")),r.append(d.append(i[n].optgroup)).wrapInner('<div class="optGroupLabel"></div>').append(t(s,i[n].options,l)),h.append(r)):h.append(c(s,i[n],l));return h.children()}(this.attr("id"),t,p)),l.ultraselect("setListHeight",p.listHeight),p.multiple?(p.multiple&&p.selectAll&&d.find("input.selectAll").click(function(){d.find("input:checkbox").prop("checked",e(this).is(":checked")).parent().toggleClass("checked",e(this).is(":checked"))}),p.multiple&&p.optGroupSelectable&&(d.addClass("optGroupHasCheckboxes"),d.find("input.optGroup").click(function(){e(this).parent().parent().find("input:not(.optGroup, .selectAll):checkbox").prop("checked",e(this).is(":checked")).parent().toggleClass("checked",e(this).is(":checked"))})),d.find("input:checkbox").click(function(){e(this).parent().toggleClass("checked",e(this).is(":checked")),n.call(l,!0),r.focus(),e(this).parent().parent().hasClass("optGroup")&&a.call(l,e(this).parent().parent()),u&&u(e(this))}),d.each(function(){e(this).find("input:checked").parent().addClass("checked")}),n.call(l,!1),p.optGroupSelectable&&d.find("div.optGroup").each(function(){a.call(l,e(this))}),d.find("input:checkbox").parent().addClass("selectable")):(n.call(l,!1),e(".option",d).click(function(){e("input",l).val(e(this).data("value")),l.ultraselect("hideOptions"),n.call(l,!0),r.focus()})),d.find(".selectable").hover(function(){e(this).parent().find(".hover").removeClass("hover"),e(this).addClass("hover")},function(){p.multiple&&e(this).removeClass("hover")}),r.keydown(function(t){var s,a,o;if(d=e(this).next(".options"),"hidden"!==l.parent().css("overflow")){if(9===t.keyCode)return e(this).addClass("focus").trigger("click"),!0;if(27!==t.keyCode&&37!==t.keyCode&&39!==t.keyCode||e(this).addClass("focus").trigger("click"),40===t.keyCode||38===t.keyCode)return o=-1,(a=(s=d.find(".selectable")).index(s.filter(".hover")))<0?d.find(".selectable:first").addClass("hover"):40===t.keyCode&&a<s.length-1?o=a+1:38===t.keyCode&&a>0&&(o=a-1),o>=0&&(e(s.get(a)).removeClass("hover"),e(s.get(o)).addClass("hover"),i(d)),!1;if(13===t.keyCode||32===t.keyCode){p.multiple||e(".option.hover",d).trigger("click");var c=d.find("div.hover input:checkbox");return c.prop("checked",!c.is(":checked")).parent().toggleClass("checked",c.is(":checked")),c.hasClass("selectAll")&&d.find("input:checkbox").prop("checked",c.is(":checked")).parent().addClass("checked").toggleClass("checked",c.is(":checked")),n.call(l,!0),u&&u(e(this)),!1}if(t.keyCode>=33&&t.keyCode<=126){var r=d.find(".selectable:startsWith("+String.fromCharCode(t.keyCode)+")"),h=r.index(r.filter(".selectable.hover")),f=r.filter(function(e){return e>h});1===(r=(r=f.length>=1?f:r).filter(".selectable:first")).length&&(d.find(".selectable.hover").removeClass("hover"),r.addClass("hover"),i(d))}}else{if(!p.multiple&&(40===t.keyCode||38===t.keyCode))return o=a=(s=d.find(".selectable")).index(s.filter(".hover")),a<0?o=0:40===t.keyCode&&a<s.length-1?o=a+1:38===t.keyCode&&a>0&&(o=a-1),s.removeClass("hover"),e(s.get(o)).addClass("hover").trigger("click"),!1;if(38===t.keyCode||40===t.keyCode||13===t.keyCode||32===t.keyCode)return e(this).removeClass("focus").trigger("click"),d.find(".selectable:first").addClass("hover"),!1;if(9===t.keyCode)return!0}if(13===t.keyCode)return!1})}function d(t,i,l){this.element=t,this.options=e.extend(!0,{},s,i),this.callback=l,this.init()}e.extend(d.prototype,{init:function(){var t=this.options,s=e(this.element);t.maxWidth="none"!==s.css("maxWidth")?s.css("maxWidth"):t.maxWidth,t.multiple=s.attr("multiple"),t.name=s.attr("name");var i=e("<div />",{class:"ultraselect"}),a=e("<div />",{class:"select",tabIndex:0}),n=e("<div />",{class:"options",tabIndex:-1});t.multiple||i.append(e("<input />",{type:"hidden",name:t.name,value:s.val()})),a.append(e("<span />",{class:"selection"}),e("<span />",{class:"arrow"}).append(e("<b />"))),i.append(a,n),s.after(i),t.maxWidth&&a.css("maxWidth",t.maxWidth),i.addClass(s.attr("class")),i.data(s.data()),this.element=i[0],i.data("ultraselect",this);var o=[];s.children().each(function(){if("optgroup"===this.tagName.toLowerCase()){var t=[];o.push({optgroup:e(this).attr("label"),options:t,classes:e(this).attr("class"),data:e(this).data()||{}}),e(this).children("option").each(function(){""!==e(this).val()&&t.push({text:e(this).html(),value:e(this).val(),selected:e(this).prop("selected"),classes:e(this).attr("class"),data:e(this).data()||{}})})}else"option"===this.tagName.toLowerCase()&&""!==e(this).val()&&o.push({text:e(this).html(),value:e(this).val(),selected:e(this).prop("selected"),classes:e(this).attr("class"),data:e(this).data()||{}})}),s.remove(),i.attr("id",s.attr("id")),r.call(i,o),i.wrap('<div class="ultraselectWrapper"></div>'),i.parent().height(a.outerHeight()),l.call(i),e(window).resize(function(){l.call(i)}),a.hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")}).click(function(){return e(this).hasClass("active")?i.ultraselect("hideOptions"):i.ultraselect("showOptions"),!1}).focus(function(){e(this).addClass("focus")}).blur(function(){e(this).removeClass("focus")}),e(document).click(function(t){e(t.target).parents().addBack().is(".ultraselect > .options")||i.ultraselect("hideOptions")})},getValue:function(){var t=[];return this.options.multiple?(e("input:not(.selectAll, .optGroup)",this.element).each(function(){e(this).is(":checked")&&t.push(e(this).val())}),t):e("input",this.element).val()},setValue:function(t){var s=this.element;this.options.multiple||(e("input",s).val(t),e(".option",s).removeClass("hover").each(function(){e(this).val()===t&&(e(this).addClass("hover"),e("span.selection",s).html(e("label",this).text()))}));var i=t||[];return"string"==typeof i&&(i=[t]),i='"'+t+'"',e("input:not(.selectAll, .optGroup)",s).each(function(){var t=-1!==i.indexOf(e(this).val());e(this).prop("checked",t).parent().toggleClass("checked",t)}),n.call(e(s),!1),this},update:function(){n.call(this)},updateOptions:function(e){r.call(this,e)},hideOptions:function(){this.children(".select").removeClass("active").removeClass("hover"),this.parent().css("overflow","hidden"),this.parent().css("z-index","1")},showOptions:function(){var t=this.children(".select"),s=this.children(".options"),i=this.data("ultraselect").options;if(e(".ultraselect").ultraselect("hideOptions"),this.parent().css("overflow","visible"),this.parent().css("z-index","99"),s.find(".option, .optGroup").removeClass("hover"),t.addClass("active").focus(),i.multiple)s.scrollTop(0);else{var l=this.children("input").val();s.find(".option").each(function(){if(e(this).data("value")===l)return e(this).addClass("hover"),!1})}},selectedString:function(){var t="";return this.find("input:checkbox:checked").not(".optGroup, .selectAll").each(function(){t+=e(this).attr("value")+","}),t.replace(/\s*,\s*$/,"")},setListHeight:function(e){var t=this.children(".options");(navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident/7.")>=0||navigator.userAgent.toLowerCase().indexOf("firefox")>=0||navigator.userAgent.indexOf("Edge/1")>=0)&&t.addClass("_firefox"),t.height()>e&&t.css("height",e+"px")},option:function(e,t,s){if(void 0===t)return this.data("ultraselect").options[e];this.data("ultraselect").options[e]=t,s&&n.call(this,!0)}}),e.expr[":"].startsWith=function(t,s,i){var l=i[3];return!!l&&new RegExp("^[/s]*"+l,"i").test(e(t).text())};var h=e.fn.val;e.fn.val=function(t){var s;return 0===arguments.length?(s=this.data("ultraselect"))?s.getValue():h.call(this):this.each(function(){(s=e(this).data("ultraselect"))?s.setValue(t):h.call(e(this),t)})},e.fn.ultraselect=function(t,s){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){e(this).data("ultraselect")?"string"==typeof t&&"function"==typeof d.prototype[t]?e(this).data("ultraselect")[t].apply(e(this),i):console.log("ultraselect: invalid arguments"):new d(this,t,s)})}}(jQuery);