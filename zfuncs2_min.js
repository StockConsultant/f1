function initconfig(){myConfig={"background-color":"#000",type:"mixed",title:{text:""},plot:{tooltip:{visible:!1},mode:"fast",exact:!0,smartSampling:!1,maxNodes:"100",maxTrackers:"100"},plotarea:{"background-color":"#000",margin:"dynamic"},scaleX:{itemsOverlap:!0,"max-items":100,item:{"font-family":"Arial",color:"#e4e4e4",fontSize:"12px",rules:[{rule:'"%scale-label" == "10a" || "%scale-label" == "11a" || "%scale-label" == "12p" || "%scale-label" == "1p" || "%scale-label" == "2p" || "%scale-label" == "3p"',alpha:"0.7"}]},tick:{alpha:"0",color:"#ddd",rules:[{rule:'"%scale-label" != "" || "%scale-label" == "10a" || "%scale-label" == "11a" || "%scale-label" == "12p" || "%scale-label" == "1p" || "%scale-label" == "2p" || "%scale-label" == "3p"',alpha:"1"}]},guide:{visible:!0,zIndex:"0","line-color":"#383838","line-style":"solid",alpha:"0",rules:[{rule:' "%scale-label" != "" || "%scale-label" == "10 " || "%scale-label" == "11 " || "%scale-label" == "12 " || "%scale-label" == "01"|| "%scale-label" == "02" || "%scale-label" == "03"',alpha:"1"},{rule:'"%scale-label" == "10a" || "%scale-label" == "11a" || "%scale-label" == "12p" || "%scale-label" == "1p" || "%scale-label" == "2p" || "%scale-label" == "3p"',alpha:"0.6"}]},labels:[]},scaleY:{itemsOverlap:!0,"max-items":50,item:{"font-family":"Arial",color:"#e4e4e4",fontSize:"12px"},placement:"opposite",decimals:"1","offset-start":"19%",format:"%v",values:"0:1:1",guide:{"line-style":"dotted",zIndex:"0","line-color":"#555"},label:{text:""}},scaleY2:{"max-items":3,item:{"font-family":"Arial",color:"#777",fontSize:"9px"},blended:!0,"offset-end":"86%",placement:"opposite","exponent-decimals":"0",format:"%v",values:"0:1:1",guide:{"line-style":"solid",zIndex:"0","line-color":"#333"},label:{text:""}},series:[{type:"stock",scales:"scaleX,scaleY",zIndex:"1",aspect:"candlestick","bar-width":"100%","trend-up":{"background-color":"#000","line-color":"#00ff00","border-color":"#00ff00"},"trend-down":{"background-color":"#ff1111","line-color":"#ff1111","border-color":"#ff1111"},"trend-equal":{"background-color":"#00ff00","line-color":"#00ff00","border-color":"#00ff00"},values:[]},{type:"bar",scales:"scaleX,scaleY2","background-color":"#00ff00",stacked:!0,"bar-width":"90%",values:[]},{scales:"scaleX,scaleY",zIndex:"0",marker:{visible:"false"},aspect:"spline",lineColor:"#BF48BF",lineWidth:"1px",values:[]},{type:"bar",scales:"scaleX,scaleY2","background-color":"#ff1111",stacked:!0,"bar-width":"90%",values:[]}]}}function decodedata(e){var l,a,s,t,i="",o=12,n=0,r=1;if(timeoutsecs=0,1==debugg&&(a=new Date),void 0!=e){if(1==debugg&&console.log(e),i=e,i.length>=1&&i.length<=7)if("9"==i)r=0;else if("6"==i)n=1,apidatafail++;else if("5"==i)n=1,hadtowaitglob++;else if("1"==i.charAt(0)){if(i.indexOf(",")>0){var c=i.split(",");c=parseInt(c[1]),timeoutsecs=c>=2&&3600>=c?c:60}n=1}if(0==r&&(document.getElementById("status").innerHTML=symbolin+"</span> no chart"),1==debugg&&console.log("*********************************** nochartupdate="+n),1==debugg&&console.log("before currentsdate="+currentsdate+"  currentsfidx="+currentsfidx),1==r&&0==n){i=i.split("~"),days>=i.length?days=i.length:(days=origdays,days>=i.length&&(days=i.length));var d,g,u,f,m,y,h,b,p,C,v=[1,78,39,26,13,13,7,7,7,7,7],x=[1,6,3,2,1,1,1,1,1,1,1],w=-1,X=99999999,z=[],T=0,k=0,S=[0,0,0],I=0;for(initconfig(),C=i.length-1;C>=0;C--){if(m=i[C].indexOf("]"),y=i[C].substr(0,m).split(","),h=y[0].substr(6,2),b=i[C].substr(m+1).split("["),0==C){if(currentsdate=y[0],currentsfidx=y[1],"1"==y[3]?apidatafail++:apidatafail=0,"1"==y[2]?hadtowaitglob++:hadtowaitglob=0,0==timeoutsecs&&5==y.length){var c=parseInt(y[4]);timeoutsecs=c>=2&&3600>=c?c:60}1==debugg&&console.log("j="+C+"  currentsdate="+currentsdate+"  currentsfidx="+currentsfidx+"  dataslots[days]="+v[days])}f=b.length,u=0;var Y=v[days]-f;if(1==i.length){if(f<v[days])for(g=0;Y>g;g++)b.unshift("")}else if(f<v[days])for(g=0;Y>g;g++)b.push("");d=-1;var D=0;for(g=-1;g<=v[days];g++){if(-1==g||g==v[days])g==v[days]&&0!=C?T--:(myConfig.scaleX.labels[T]="",myConfig.series[0].values.push([null,null,null,null]),myConfig.series[1].values[T]=0,myConfig.series[3].values[T]=0,myConfig.series[2].values[T]=null);else if(days>1||1==days&&1==D||""!=b[g]){D=1;var F=u/x[days];if(F-Math.floor(F)==0&&F%2==1)myConfig.scaleX.labels[T]=F>5?.5*(F-1)-2:.5*(F-1)+10,2==days&&10==myConfig.scaleX.labels[T]?myConfig.scaleX.labels[T]="":days>=3&&(10==myConfig.scaleX.labels[T]||12==myConfig.scaleX.labels[T]||2==myConfig.scaleX.labels[T])?myConfig.scaleX.labels[T]="":5!=days||10!=myConfig.scaleX.labels[T]&&11!=myConfig.scaleX.labels[T]&&12!=myConfig.scaleX.labels[T]&&2!=myConfig.scaleX.labels[T]&&3!=myConfig.scaleX.labels[T]?days>5&&(myConfig.scaleX.labels[T]=""):myConfig.scaleX.labels[T]="",""!=myConfig.scaleX.labels[T]&&(myConfig.scaleX.labels[T]+=myConfig.scaleX.labels[T]<12&&myConfig.scaleX.labels[T]>9?"a":"p");else if(0==u){var A=parseInt(h);myConfig.scaleX.labels[T]=10>A?h:10==A||11==A||12==A?parseInt(h)+" ":h}else myConfig.scaleX.labels[T]="";if(u++,""!=b[g])if(p=b[g].split(","),""!=p[3]){var B=parseFloat(p[1]),O=parseFloat(p[2]),E=parseInt(p[4]),M=parseFloat(p[0]),L=parseFloat(p[3]);if(B>w&&(w=B),X>O&&(X=O),myConfig.series[0].values.push([M,B,O,L]),E>k&&(k=E),M>L?(myConfig.series[3].values[T]=E,myConfig.series[1].values[T]=0):(myConfig.series[1].values[T]=E,myConfig.series[3].values[T]=0),E>S[0]?(S[2]=S[1],S[1]=S[0],S[0]=E):E>S[1]?(S[2]=S[1],S[1]=E):E>S[2]&&(S[2]=E),I++,d=parseFloat(p[3]),z.unshift(parseFloat(p[3])),z.length>=o){var W,j=0;for(W=0;o>W;W++)j+=z[W];myConfig.series[2].values[T]=parseFloat((j/o).toFixed(3))}else myConfig.series[2].values[T]=null}else if(d>0)if(myConfig.series[0].values.push([d,d,d,d]),myConfig.series[1].values[T]=0,myConfig.series[3].values[T]=0,z.unshift(d),z.length>=o){var W,j=0;for(W=0;o>W;W++)j+=z[W];myConfig.series[2].values[T]=parseFloat((j/o).toFixed(3))}else myConfig.series[2].values[T]=null;else myConfig.series[0].values.push([null,null,null,null]),myConfig.series[1].values[T]=0,myConfig.series[3].values[T]=0,myConfig.series[2].values[T]=null;else myConfig.series[0].values.push([null,null,null,null]),myConfig.series[1].values[T]=0,myConfig.series[3].values[T]=0,myConfig.series[2].values[T]=null}else myConfig.scaleX.labels[T]="",myConfig.series[0].values.push([null,null,null,null]),myConfig.series[1].values[T]=0,myConfig.series[3].values[T]=0,myConfig.series[2].values[T]=null;T++}}-1!=w&&99999999!=X&&(myConfig.scaleY.values=510>dwidth?X+":"+w+":"+.125*(w-X):X+":"+w+":"+.1*(w-X),myConfig.scaleY.decimals=1>X?"3":1e3>X?"2":"1");var H=0;I>20&&S[0]>2*S[2]&&(H=1,k=S[2]);var q=parseInt(.02*k);for(C=0;T>C;C++)1==H&&(myConfig.series[1].values[C]==S[0]&&(myConfig.series[1].values[C]=S[2]),myConfig.series[3].values[C]==S[0]&&(myConfig.series[3].values[C]=S[2]),myConfig.series[1].values[C]==S[1]&&(myConfig.series[1].values[C]=S[2]),myConfig.series[3].values[C]==S[1]&&(myConfig.series[3].values[C]=S[2])),myConfig.series[1].values[C]>0&&myConfig.series[1].values[C]<q&&(myConfig.series[1].values[C]=q),myConfig.series[3].values[C]>0&&myConfig.series[3].values[C]<q&&(myConfig.series[3].values[C]=q),myConfig.scaleX.labels[C]=myConfig.scaleX.labels[C].toString();k>0&&(myConfig.scaleY2.values="0:"+k+":"+parseInt(.5*k)),510>dwidth&&(myConfig.series[1].barWidth="60%",myConfig.series[3].barWidth="60%"),myConfig.series[0].aspect=0==stickchart?"candlestick":"whisker",10>w&&k>49900?(myConfig.scaleY2.exponent=!0,myConfig.scaleY2.item.fontSize="10px"):100>w&&k>499e3&&(myConfig.scaleY2.exponent=!0,myConfig.scaleY2.item.fontSize="10px"),1==debugg&&(s=new Date,console.log("setup vars time="+(s.getTime()-a.getTime())/1e3),l=new Date),zingchart.render({id:"myChart",data:myConfig,height:"100%",width:"100%"}),zingchart.bind("myChart","contextmenu",function(){return!1}),zingchart.bind("myChart","mousewheel",function(){return!1}),zingchart.bind("myChart","swipe",function(){return!1}),1==debugg&&(t=new Date,console.log("setup render time="+(t.getTime()-l.getTime())/1e3))}}}function cyclechart(){0==onetime&&1!=apidatafail&&1!=hadtowaitglob&&(hadtowaitglob=0,apidatafail=0,1==debugg&&console.log("normal getting data secs="+1e3*timeoutsecs),0==timeoutsecs&&(timeoutsecs=60),thetimeout=setTimeout(function(){getdata()},1e3*timeoutsecs)),1==apidatafail?(hadtowaitglob=0,1==debugg&&console.log("api fail or timeout getting data 1 secs"),thetimeout=setTimeout(function(){getdata()},1e3)):apidatafail=0,0==onetime&&1==hadtowaitglob?(1==debugg&&console.log("had to wait getting data 5 secs"),thetimeout=setTimeout(function(){getdata()},5e3)):hadtowaitglob=0}function loopuntilzload(e){if(1==zingloaded)1==debugg&&console.log("zingloaded in times="+zloadtries),decodedata(e.responseText),cyclechart();else{if(zloadtries++,zloadtries>maxloadtries)return;var l=100;3>=zloadtries?l=20:5>=zloadtries&&(l=40),setTimeout(function(){loopuntilzload(e)},l)}}function getdata(){return timeoutsecs=0,thetimeout&&clearTimeout(thetimeout),0==onetime&&document.hidden?("object"==typeof xhr&&xhr&&xhr.readyState&&xhr.abort(),1==debugg&&console.log("I was hidden"),void(thetimeout=setTimeout(getdata,1e3))):(1==debugg&&console.log("getting data func days="+origdays),xhr=new XMLHttpRequest,xhr.open("GET","https://www.stockconsultant.com/consultnow/"+cgiprog+".cgi?SYMBOL="+symbolin+"&DAYS="+origdays+"&SDATE="+currentsdate+"&SFIDX="+currentsfidx,!0),1==debugg&&console.log("calling https://www.stockconsultant.com/consultnow/"+cgiprog+".cgi?SYMBOL="+symbolin+"&DAYS="+origdays+"&SDATE="+currentsdate+"&SFIDX="+currentsfidx),xhr.timeout=4500,xhr.onload=function(){4===xhr.readyState&&(1==debugg&&(endt=new Date,console.log("xhr sucess time="+(endt.getTime()-startt.getTime())/1e3)),xhr.readyState=null,200===xhr.status?(zloadtries=0,loopuntilzload(xhr)):(apidatafail++,cyclechart()))},xhr.ontimeout=function(){1==debugg&&(endt=new Date,console.log("timeout error time="+(endt.getTime()-startt.getTime())/1e3)),xhr.readyState=null,apidatafail++,cyclechart()},xhr.onerror=function(){1==debugg&&(endt=new Date,console.log("xhr error time="+(endt.getTime()-startt.getTime())/1e3)),xhr.readyState=null,apidatafail++,cyclechart()},1==debugg&&(startt=new Date),void xhr.send(null))}function getinput(){var e=0,l=window.location.search.substr(1).split(","),a=document.getElementById("myChart"),s=a.offsetHeight;dwidth=a.offsetWidth,1==debugg&&console.log("dheight="+s+"   dwidth="+dwidth),s>400?(a.style.width="101%",a.style.height="101%"):s>357?(a.style.width="102%",a.style.height="104%"):270>s&&(a.style.width="103%",a.style.height="114%"),window.location.search.length<20&&(4!=l.length?e=1:(days=parseInt(l[1]),(1>days||days>10||4==days)&&(e=1),symbolin=l[0],symbolin.length>7&&(e=1),onetime=l[2],0!=onetime&&1!=onetime&&(e=1),stickchart=l[3]),0==e&&(origdays=days,getdata()))}var myConfig,thetimeout,errorstr="",xhr,days,currentsdate="1",currentsfidx="1",cgiprog="screaltime1b2",hadtowaitglob=0,apidatafail=0,onetime=1,origdays,stickchart=0,j,startt,endt,zloadtries=0,maxloadtries=95,dwidth;